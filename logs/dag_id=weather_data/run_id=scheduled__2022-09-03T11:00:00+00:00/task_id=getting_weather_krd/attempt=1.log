[2022-09-03T12:00:02.778+0000] {taskinstance.py:1171} INFO - Dependencies all met for <TaskInstance: weather_data.getting_weather_krd scheduled__2022-09-03T11:00:00+00:00 [queued]>
[2022-09-03T12:00:02.784+0000] {taskinstance.py:1171} INFO - Dependencies all met for <TaskInstance: weather_data.getting_weather_krd scheduled__2022-09-03T11:00:00+00:00 [queued]>
[2022-09-03T12:00:02.785+0000] {taskinstance.py:1368} INFO - 
--------------------------------------------------------------------------------
[2022-09-03T12:00:02.786+0000] {taskinstance.py:1369} INFO - Starting attempt 1 of 1
[2022-09-03T12:00:02.787+0000] {taskinstance.py:1370} INFO - 
--------------------------------------------------------------------------------
[2022-09-03T12:00:02.795+0000] {taskinstance.py:1389} INFO - Executing <Task(SimpleHttpOperator): getting_weather_krd> on 2022-09-03 11:00:00+00:00
[2022-09-03T12:00:02.799+0000] {standard_task_runner.py:52} INFO - Started process 11864 to run task
[2022-09-03T12:00:02.801+0000] {standard_task_runner.py:79} INFO - Running: ['***', 'tasks', 'run', 'weather_data', 'getting_weather_krd', 'scheduled__2022-09-03T11:00:00+00:00', '--job-id', '235', '--raw', '--subdir', 'DAGS_FOLDER/first_dag.py', '--cfg-path', '/tmp/tmp9gw4c2jx', '--error-file', '/tmp/tmpdcnrrsqz']
[2022-09-03T12:00:02.802+0000] {standard_task_runner.py:80} INFO - Job 235: Subtask getting_weather_krd
[2022-09-03T12:00:02.845+0000] {task_command.py:371} INFO - Running <TaskInstance: weather_data.getting_weather_krd scheduled__2022-09-03T11:00:00+00:00 [running]> on host 3d56073112d8
[2022-09-03T12:00:02.888+0000] {taskinstance.py:1583} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=weather_data
AIRFLOW_CTX_TASK_ID=getting_weather_krd
AIRFLOW_CTX_EXECUTION_DATE=2022-09-03T11:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-09-03T11:00:00+00:00
[2022-09-03T12:00:02.889+0000] {http.py:121} INFO - Calling HTTP method
[2022-09-03T12:00:02.896+0000] {base.py:68} INFO - Using connection ID 'http_default' for task execution.
[2022-09-03T12:00:02.899+0000] {http.py:148} INFO - Sending 'GET' to url: http://api.openweathermap.org/data/2.5/weather
[2022-09-03T12:00:05.186+0000] {http.py:206} WARNING - ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response')) Tenacity will retry to execute the operation
[2022-09-03T12:00:05.192+0000] {taskinstance.py:1902} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 449, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 444, in _make_request
    httplib_response = conn.getresponse()
  File "/usr/local/lib/python3.7/http/client.py", line 1373, in getresponse
    response.begin()
  File "/usr/local/lib/python3.7/http/client.py", line 319, in begin
    version, status, reason = self._read_status()
  File "/usr/local/lib/python3.7/http/client.py", line 288, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
http.client.RemoteDisconnected: Remote end closed connection without response

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 499, in send
    timeout=timeout,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 788, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 550, in increment
    raise six.reraise(type(error), error, _stacktrace)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/packages/six.py", line 769, in reraise
    raise value.with_traceback(tb)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 449, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 444, in _make_request
    httplib_response = conn.getresponse()
  File "/usr/local/lib/python3.7/http/client.py", line 1373, in getresponse
    response.begin()
  File "/usr/local/lib/python3.7/http/client.py", line 319, in begin
    version, status, reason = self._read_status()
  File "/usr/local/lib/python3.7/http/client.py", line 288, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
urllib3.exceptions.ProtocolError: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/http/operators/http.py", line 123, in execute
    response = http.run(self.endpoint, self.data, self.headers, self.extra_options)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/http/hooks/http.py", line 149, in run
    return self.run_and_check(session, prepped_request, extra_options)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/http/hooks/http.py", line 207, in run_and_check
    raise ex
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/http/hooks/http.py", line 199, in run_and_check
    response = session.send(prepped_request, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 547, in send
    raise ConnectionError(err, request=request)
requests.exceptions.ConnectionError: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response'))
[2022-09-03T12:00:05.213+0000] {taskinstance.py:1412} INFO - Marking task as FAILED. dag_id=weather_data, task_id=getting_weather_krd, execution_date=20220903T110000, start_date=20220903T120002, end_date=20220903T120005
[2022-09-03T12:00:05.226+0000] {standard_task_runner.py:97} ERROR - Failed to execute job 235 for task getting_weather_krd (('Connection aborted.', RemoteDisconnected('Remote end closed connection without response')); 11864)
[2022-09-03T12:00:05.247+0000] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-09-03T12:00:05.281+0000] {local_task_job.py:279} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-09-03T12:10:10.032+0000] {taskinstance.py:1171} INFO - Dependencies all met for <TaskInstance: weather_data.getting_weather_krd scheduled__2022-09-03T11:00:00+00:00 [queued]>
[2022-09-03T12:10:10.040+0000] {taskinstance.py:1171} INFO - Dependencies all met for <TaskInstance: weather_data.getting_weather_krd scheduled__2022-09-03T11:00:00+00:00 [queued]>
[2022-09-03T12:10:10.041+0000] {taskinstance.py:1368} INFO - 
--------------------------------------------------------------------------------
[2022-09-03T12:10:10.042+0000] {taskinstance.py:1369} INFO - Starting attempt 1 of 1
[2022-09-03T12:10:10.043+0000] {taskinstance.py:1370} INFO - 
--------------------------------------------------------------------------------
[2022-09-03T12:10:10.053+0000] {taskinstance.py:1389} INFO - Executing <Task(SimpleHttpOperator): getting_weather_krd> on 2022-09-03 11:00:00+00:00
[2022-09-03T12:10:10.058+0000] {standard_task_runner.py:52} INFO - Started process 12379 to run task
[2022-09-03T12:10:10.062+0000] {standard_task_runner.py:79} INFO - Running: ['***', 'tasks', 'run', 'weather_data', 'getting_weather_krd', 'scheduled__2022-09-03T11:00:00+00:00', '--job-id', '238', '--raw', '--subdir', 'DAGS_FOLDER/first_dag.py', '--cfg-path', '/tmp/tmpk7jl5rr2', '--error-file', '/tmp/tmpe_u8u2la']
[2022-09-03T12:10:10.064+0000] {standard_task_runner.py:80} INFO - Job 238: Subtask getting_weather_krd
[2022-09-03T12:10:10.108+0000] {task_command.py:371} INFO - Running <TaskInstance: weather_data.getting_weather_krd scheduled__2022-09-03T11:00:00+00:00 [running]> on host 3d56073112d8
[2022-09-03T12:10:10.155+0000] {taskinstance.py:1583} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=weather_data
AIRFLOW_CTX_TASK_ID=getting_weather_krd
AIRFLOW_CTX_EXECUTION_DATE=2022-09-03T11:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-09-03T11:00:00+00:00
[2022-09-03T12:10:10.157+0000] {http.py:121} INFO - Calling HTTP method
[2022-09-03T12:10:10.164+0000] {base.py:68} INFO - Using connection ID 'http_default' for task execution.
[2022-09-03T12:10:10.167+0000] {http.py:148} INFO - Sending 'GET' to url: http://api.openweathermap.org/data/2.5/weather
[2022-09-03T12:10:12.258+0000] {taskinstance.py:1412} INFO - Marking task as SUCCESS. dag_id=weather_data, task_id=getting_weather_krd, execution_date=20220903T110000, start_date=20220903T121010, end_date=20220903T121012
[2022-09-03T12:10:12.285+0000] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-09-03T12:10:12.315+0000] {local_task_job.py:279} INFO - 1 downstream tasks scheduled from follow-on schedule check
